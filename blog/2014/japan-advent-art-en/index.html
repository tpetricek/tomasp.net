<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
  <meta name=viewport content="width=device-width, initial-scale=1">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Droid+Sans+Mono&family=Kreon:wght@300;400;500;600&family=PT+Sans:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="alternate" type="application/rss+xml" title="Latest news from Tomas Petricek" href="/rss.xml" />
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <link href="/custom/style.css" rel="stylesheet">
  <link href="/custom/tooltips.css" rel="stylesheet">
  <script src="/custom/tooltips.js" type="text/javascript"></script>
  <link rel="apple-touch-icon" sizes="180x180" href="/img/favicon-big.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/img/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/img/favicon-big.png">
  <meta name="msapplication-TileColor" content="#004C6B">
  <meta name="msapplication-TileImage" content="/img/favicon-big.png">
  <meta name="theme-color" content="#004C6B">
  
  <title>Advent Art: Generating Hokusai paintings - Tomas Petricek</title>

  <meta name="description" content=" This article is a contribution to the F# Advent Calendar that is organized every year by the Japanese F# community - and so the article is inspired by the Japanese culture. We look at a list of Japanese artists in Freebase and try to recreate one piece using fractals and FunScript!" />
  <meta name="keywords" content="f#, art, fractals, funscript, f# data, " />  
  <meta name="author" content="Tomas Petricek" />
  <meta name="copyright" content="Tomas Petricek" />
  
  <meta property="og:title" content="Advent Art: Generating Hokusai paintings" />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="http://tomasp.net/blog/2014/japan-advent-art-en/" />
  <meta property="og:image" content="http://tomasp.net/blog/2014/japan-advent-art-en/hokusai_sm.jpg" />
  <meta property="og:description" content=" This article is a contribution to the F# Advent Calendar that is organized every year by the Japanese F# community - and so the article is inspired by the Japanese culture. We look at a list of Japanese artists in Freebase and try to recreate one piece using fractals and FunScript!" />
  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:site" content="@tomaspetricek">
  <meta name="twitter:creator" content="@tomaspetricek">  
  <meta name="twitter:title" content="Advent Art: Generating Hokusai paintings" />
  <meta name="twitter:image" content="http://tomasp.net/blog/2014/japan-advent-art-en/hokusai_sm.jpg" />
  <meta name="twitter:description" content=" This article is a contribution to the F# Advent Calendar that is organized every year by the Japanese F# community - and so the article is inspired by the Japanese culture. We look at a list of Japanese artists in Freebase and try to recreate one piece using fractals and FunScript!" />
    
  <script type="application/ld+json">
  {
  	"@context": "http:\/\/schema.org",
  	"@type": "Article",
  	"name": "Advent Art: Generating Hokusai paintings",
    "headline": "Advent Art: Generating Hokusai paintings",
  	"description": " This article is a contribution to the F# Advent Calendar that is organized every year by the Japanese F# community - and so the article is inspired by the Japanese culture. We look at a list of Japanese artists in Freebase and try to recreate one piece using fractals and FunScript!",
  	"url": "http://tomasp.net/blog/2014/japan-advent-art-en/",
  	"author": {
  		"@type": "Person",
  		"name": "Tomas Petricek",
  		"url": "http://tomasp.net",
  		"sameAs": ["http://twitter.com/tomaspetricek"]
  	},
  	"creator": ["Tomas Petricek"],
  	"dateCreated": "2014-01-21T18:49:00.0000000",
  	"datePublished": "2014-01-21T18:49:00.0000000",
    "dateModified": "2014-01-21T18:49:00.0000000",
    "mainEntityOfPage": "http://tomasp.net/blog/2014/japan-advent-art-en/",
  	"image": "http://tomasp.net/blog/2014/japan-advent-art-en/hokusai_sm.jpg",
  	"thumbnailUrl": "http://tomasp.net/blog/2014/japan-advent-art-en/hokusai_sm.jpg",
  	"keywords": ["f#", "art", "fractals", "funscript", "f# data",  "tomas", "petricek"],
  	"inLanguage": "en-us",
  	"publisher": {
  		"@type": "Person",
  		"name": "Tomas Petricek",
  		"url": "http://tomasp.net",
      "logo": "http://tomasp.net/img/favicon-big.png",
  		"sameAs": ["http://twitter.com/tomaspetricek"]
  	}
  }  
  </script>

</head>
<body class="default">
    
  <span class="tplink"><a href="/">TP</a></span>

  <article class='article''>
    <h1><span class="hm">Advent Art</span><span class="hs"> Generating Hokusai paintings</span></h1>
<div id="myModal" class="reveal-modal xlarge" data-reveal>
  <iframe src="http://tomasp.net/blog/2014/japan-advent-art-en/hokusai.html" style="width:100%; height:850px;border-style:none;"></iframe>
  <a class="close-reveal-modal">&#215;</a>
</div>
<div class="rdecor" style="text-align:center">
<a href="#" data-reveal-id="myModal" style="text-align:center">
<img src="http://tomasp.net/blog/2014/japan-advent-art-en/hokusai_sm.jpg" style="margin-bottom:10px;border:4px solid black" title="The Great Wave off Kanagawa" /><br />
<small style="font-size:90%">Click here to see the result live!</small>
</a>
</div>
<p>For the last few years, the Japanese F# community has been running the F# Advent Calendar
(<a href="http://atnd.org/events/10685">2010</a>, <a href="http://partake.in/events/1c24993a-c475-4fc2-bca4-7a1cd2f81869">2011</a>, <a href="http://atnd.org/events/33927">2012</a>).
Each advent day, one person writes an article about something interesting in F#. I have
been following the advent calendar last year on Twitter and when the planning started for
this year, I offered to write an article too. You might have noticed that I posted a
<a href="http://tomasp.net/blog/2013/japan-advent-art/index.html">Japanese version of the article</a>
in December as part of the <a href="http://connpass.com/event/3935/">advent calendar 2013</a>.</p>
<p>A number of people helped to make this happen - <a href="http://twitter.com/igeta">@igeta</a> arranged everything and
helped with reviewing, <a href="http://twitter.com/yukitos">@yukitos</a> translated the article and
<a href="http://twitter.com/gab_km">@gab_km</a> reviewed the translation. Thanks!</p>
<p>But what should I write about? It would be nice to look at some of the F# open-source libraries
and projects that have been developing over the last year in the F# community. At the same time,
can I relate the topic of the article to Japan? After some thinking, I came up with the following
plan:</p>
<ul>
<li>
<p>First, we'll use the <a href="http://fsharp.github.io/FSharp.Data/">F# Data</a> library and the <a href="http://www.freebase.com">Freebase</a> to learn
something about Japanese art. I should add that thanks to <a href="https://twitter.com/yukitos">@yukitos</a> the library now also has
a <a href="http://fsharp.github.io/FSharp.Data/jp">documentation in Japanese</a>.</p>
</li>
<li>
<p>Then we'll pick one art work and try to recreate it in F#. Given my artistic skills, this
part will definitely fail, but we can try :-).</p>
</li>
<li>
<p>Finally, we'll use the <a href="http://funscript.info">FunScript project</a> to turn our F# code into
JavaScript, so that we can run it as a pure HTML web application that also works on mobile
phones and other devices.</p>
</li>
</ul>
<h2>Exploring Japanese art</h2>
<p><a href="http://www.freebase.com">Freebase</a> is an online graph database with schematized information,
mostly based on data from Wikipedia. It contains information about a wide range of topics
including society (governments, celebrities, etc.), sports (different kinds), science (computers,
chemistry, etc.) and also art.</p>
<p>The F# type provider for Freebase in F# Data gives us a way to access all this knowledge directly
from a code editor. To use it, you can install NuGet package <code>FSharp.Data</code> and reference the
assembly as follows:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="prep">#I</span> <span class="s">&quot;../packages/FSharp.Data.1.1.10/lib/net40&quot;</span>
<span class="prep">#r</span> <span class="s">&quot;FSharp.Data.dll&quot;</span>

<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">FSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">Data</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="i">Linq</span>
</code></pre></td>
</tr>
</table>
<p>Aside from <code>FSharp.Data</code>, we'll also use some of the LINQ methods to explore the data.
The Freebase can be accessed using <code>FreebaseData</code> or using <code>FreebaseDataProvider</code> - the
latter one takes an API key which is needed for code that makes larger number of
requests. To run the complete sample, you'll probably need to register:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="t">FreebaseData</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="t">FreebaseDataProvider</span><span class="o">&lt;</span><span id="fst7" onmouseout="hideTip(event, 'fs7', 7)" onmouseover="showTip(event, 'fs7', 7, document.getElementById('fst7'))" class="omitted">(insert your key)</span><span class="o">&gt;</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs8', 8)" onmouseover="showTip(event, 'fs8', 8)" class="i">fb</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 9)" onmouseover="showTip(event, 'fs5', 9)" class="t">FreebaseData</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs9', 10)" onmouseover="showTip(event, 'fs9', 10)" class="f">GetDataContext</span>()
</code></pre></td>
</tr>
</table>
<p>Now you can type <code>fb.</code> and see a list of areas that are available in Freebase.
For example, we can look at the "Visual Art" category that contains paintings and
painters, get the first painter in the list (called "Visual Artists") and explore
some information about the painter:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs10', 11)" onmouseover="showTip(event, 'fs10', 11)" class="i">art</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs8', 12)" onmouseover="showTip(event, 'fs8', 12)" class="i">fb</span><span class="o">.</span><span class="i">``Arts and Entertainment``</span><span class="o">.</span><span class="i">``Visual Art``</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs11', 13)" onmouseover="showTip(event, 'fs11', 13)" class="i">ldv</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs10', 14)" onmouseover="showTip(event, 'fs10', 14)" class="i">art</span><span class="o">.</span><span class="i">``Visual Artists``</span><span class="o">.</span><span class="i">First</span>()
<span onmouseout="hideTip(event, 'fs11', 15)" onmouseover="showTip(event, 'fs11', 15)" class="i">ldv</span><span class="o">.</span><span class="i">``Country of nationality``</span>
<span onmouseout="hideTip(event, 'fs11', 16)" onmouseover="showTip(event, 'fs11', 16)" class="i">ldv</span><span class="o">.</span><span class="i">Artworks</span>
</code></pre></td>
</tr>
</table>
<p>If you try running the code, you'll see that the first painter returned from the list
is Leonardo da Vinci. The <code>Country of nationality</code> property actually returns a list,
but here we get just a single country, which is Italy. We can also get a list of paintings
using the <code>Artworks</code> property.</p>
<p>Next, we can write a query that will find all artists with Japanese nationality (to
make things simpler, we only check the first nationality in the list):</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
<span class="l">9: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// Query to find all Japanese artists</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs12', 17)" onmouseover="showTip(event, 'fs12', 17)" class="i">artists</span> <span class="o">=</span>
  <span onmouseout="hideTip(event, 'fs13', 18)" onmouseover="showTip(event, 'fs13', 18)" class="i">query</span> { <span class="k">for</span> <span onmouseout="hideTip(event, 'fs14', 19)" onmouseover="showTip(event, 'fs14', 19)" class="i">p</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs10', 20)" onmouseover="showTip(event, 'fs10', 20)" class="i">art</span><span class="o">.</span><span class="i">``Visual Artists``</span> <span class="k">do</span>
          <span onmouseout="hideTip(event, 'fs15', 21)" onmouseover="showTip(event, 'fs15', 21)" class="k">where</span> (<span onmouseout="hideTip(event, 'fs14', 22)" onmouseover="showTip(event, 'fs14', 22)" class="i">p</span><span class="o">.</span><span class="i">``Country of nationality``</span><span class="o">.</span><span class="i">Count</span>() <span class="o">&gt;</span> <span class="n">0</span>)
          <span onmouseout="hideTip(event, 'fs15', 23)" onmouseover="showTip(event, 'fs15', 23)" class="k">where</span> (<span onmouseout="hideTip(event, 'fs14', 24)" onmouseover="showTip(event, 'fs14', 24)" class="i">p</span><span class="o">.</span><span class="i">``Country of nationality``</span><span class="o">.</span><span class="i">First</span>()<span class="o">.</span><span class="i">Name</span> <span class="o">=</span> <span class="s">&quot;Japan&quot;</span>) }

<span class="c">// Print the names of the artists found</span>
<span class="k">for</span> <span onmouseout="hideTip(event, 'fs16', 25)" onmouseover="showTip(event, 'fs16', 25)" class="i">a</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs12', 26)" onmouseover="showTip(event, 'fs12', 26)" class="i">artists</span> <span class="k">do</span> 
  <span onmouseout="hideTip(event, 'fs17', 27)" onmouseover="showTip(event, 'fs17', 27)" class="f">printfn</span> <span class="s">&quot;</span><span class="pf">%s</span><span class="s"> (</span><span class="pf">%s</span><span class="s">)&quot;</span> <span onmouseout="hideTip(event, 'fs16', 28)" onmouseover="showTip(event, 'fs16', 28)" class="i">a</span><span class="o">.</span><span class="i">Name</span> <span onmouseout="hideTip(event, 'fs16', 29)" onmouseover="showTip(event, 'fs16', 29)" class="i">a</span><span class="o">.</span><span class="i">``Date of birth``</span>
</code></pre></td>
</tr>
</table>
<p>When you run the snippet, the first artists that are returned are Yoshitaka Amano, Isamu
Noguchi and Takashi Murakami, all born in the 20th century. We could add <code>sortBy</code> or
<code>sortByDescending</code> to specify the order. We can also search for a specified artist
and use <code>head</code> to get detailed information about a single artist:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// Find detailed information about Hokusai</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs18', 30)" onmouseover="showTip(event, 'fs18', 30)" class="i">hok</span> <span class="o">=</span> 
  <span onmouseout="hideTip(event, 'fs13', 31)" onmouseover="showTip(event, 'fs13', 31)" class="i">query</span> { <span class="k">for</span> <span onmouseout="hideTip(event, 'fs19', 32)" onmouseover="showTip(event, 'fs19', 32)" class="i">p</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs10', 33)" onmouseover="showTip(event, 'fs10', 33)" class="i">art</span><span class="o">.</span><span class="i">``Visual Artists``</span> <span class="k">do</span>
          <span onmouseout="hideTip(event, 'fs15', 34)" onmouseover="showTip(event, 'fs15', 34)" class="k">where</span> (<span onmouseout="hideTip(event, 'fs19', 35)" onmouseover="showTip(event, 'fs19', 35)" class="i">p</span><span class="o">.</span><span class="i">Name</span> <span class="o">=</span> <span class="s">&quot;Hokusai&quot;</span>)
          <span onmouseout="hideTip(event, 'fs20', 36)" onmouseover="showTip(event, 'fs20', 36)" class="k">head</span> }

<span class="c">// Print image URL, description &amp; list of artworks</span>
<span onmouseout="hideTip(event, 'fs17', 37)" onmouseover="showTip(event, 'fs17', 37)" class="f">printfn</span> <span class="s">&quot;&lt;img src=</span><span class="e">\&quot;</span><span class="s"></span><span class="pf">%s</span><span class="s"></span><span class="e">\&quot;</span><span class="s"> /&gt;&quot;</span> <span onmouseout="hideTip(event, 'fs18', 38)" onmouseover="showTip(event, 'fs18', 38)" class="i">hok</span><span class="o">.</span><span class="i">MainImage</span>
<span onmouseout="hideTip(event, 'fs17', 39)" onmouseover="showTip(event, 'fs17', 39)" class="f">printfn</span> <span class="s">&quot;&lt;p&gt;</span><span class="pf">%s</span><span class="s">&lt;/p&gt;&quot;</span> (<span onmouseout="hideTip(event, 'fs18', 40)" onmouseover="showTip(event, 'fs18', 40)" class="i">hok</span><span class="o">.</span><span class="i">Blurb</span><span class="o">.</span><span class="i">First</span>())
<span class="k">for</span> <span onmouseout="hideTip(event, 'fs16', 41)" onmouseover="showTip(event, 'fs16', 41)" class="i">a</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs18', 42)" onmouseover="showTip(event, 'fs18', 42)" class="i">hok</span><span class="o">.</span><span class="i">Artworks</span> <span class="k">do</span>
  <span onmouseout="hideTip(event, 'fs17', 43)" onmouseover="showTip(event, 'fs17', 43)" class="f">printfn</span> <span class="s">&quot;&lt;h3&gt;</span><span class="pf">%s</span><span class="s">&lt;/h3&gt;&lt;img src=</span><span class="e">\&quot;</span><span class="s"></span><span class="pf">%s</span><span class="s"></span><span class="e">\&quot;</span><span class="s"> /&gt;&quot;</span> <span onmouseout="hideTip(event, 'fs16', 44)" onmouseover="showTip(event, 'fs16', 44)" class="i">a</span><span class="o">.</span><span class="i">Name</span> <span onmouseout="hideTip(event, 'fs16', 45)" onmouseover="showTip(event, 'fs16', 45)" class="i">a</span><span class="o">.</span><span class="i">MainImage</span>
</code></pre></td>
</tr>
</table>
<p>The second part of the snippet prints different information about Hokusai in HTML format.
The results look as follows:</p>
<img src="https://usercontent.googleapis.com/freebase/v1/image/wikipedia/images/commons_id/447534?key=AIzaSyCEgJTvxPjj6zqLKTK06nPYkUooSO1tB0w" class="rdecor" />
<blockquote>
<p>
Katsushika Hokusai (葛飾 北斎, September 23, 1760 – May 10, 1849) was a Japanese artist, 
ukiyo-e painter and printmaker of the Edo period. He was influenced by such painters as 
Sesshu, and other styles of Chinese painting. Born in Edo (now Tokyo), Hokusai is best 
known as author of the woodblock print series Thirty-six Views of Mount Fuji (富嶽三十六景, 
Fugaku Sanjūroku-kei, c. 1831) which includes the internationally recognized print, The 
Great Wave off Kanagawa, created during the 1820s. 
</p>
<div class="row">
  <div class="large-3 columns" style="text-align:center">
    <strong>The Dream of the Fisherman's Wife</strong><br /><img style="margin:10px" src="https://usercontent.googleapis.com/freebase/v1/image/wikipedia/images/commons_id/120391?key=AIzaSyCEgJTvxPjj6zqLKTK06nPYkUooSO1tB0w" />
  </div>
  <div class="large-3 columns" style="text-align:center">
    <strong>The Great Wave off Kanagawa</strong><br /><img style="margin:10px" src="https://usercontent.googleapis.com/freebase/v1/image/wikipedia/images/commons_id/2646210?key=AIzaSyCEgJTvxPjj6zqLKTK06nPYkUooSO1tB0w" />
  </div>
  <div class="large-3 columns" style="text-align:center">
    <strong>Travellers Crossing the Oi River</strong><br /><img style="margin:10px" src="https://usercontent.googleapis.com/freebase/v1/image/m/07h65g7?key=AIzaSyCEgJTvxPjj6zqLKTK06nPYkUooSO1tB0w" />
  </div>
  <div class="large-3 columns" style="text-align:center">
    <strong>Red Fuji</strong><br /><img style="margin:10px" src="https://usercontent.googleapis.com/freebase/v1/image/wikipedia/images/commons_id/313228?key=AIzaSyCEgJTvxPjj6zqLKTK06nPYkUooSO1tB0w" />
  </div>
</div> 
<div class="row">
  <div class="large-3 columns" style="text-align:center">
    <strong>Feminine Wave</strong><br /><img style="margin:10px" src="https://usercontent.googleapis.com/freebase/v1/image/m/07h6hz5?key=AIzaSyCEgJTvxPjj6zqLKTK06nPYkUooSO1tB0w" />
  </div>
  <div class="large-3 columns" style="text-align:center">
    <strong>Masculine Wave</strong><br /><img style="margin:10px" src="https://usercontent.googleapis.com/freebase/v1/image/m/07h6kpr?key=AIzaSyCEgJTvxPjj6zqLKTK06nPYkUooSO1tB0w" />
  </div>
  <div class="large-3 columns" style="text-align:center">
    <strong>Black Fuji</strong><br /><img style="margin:10px" src="https://usercontent.googleapis.com/freebase/v1/image/m/07h6qjh?key=AIzaSyCEgJTvxPjj6zqLKTK06nPYkUooSO1tB0w" />
  </div>
  <div class="large-3 columns" style="text-align:center">
    <strong>Oceans of Wisdom</strong><br /><img style="margin:10px" src="https://usercontent.googleapis.com/freebase/v1/image/wikipedia/images/en_id/25174350?key=AIzaSyCEgJTvxPjj6zqLKTK06nPYkUooSO1tB0w" />
  </div>
</div> 
</blockquote>
<h2>Hokusai and fractals</h2>
<p>If you look at the paintings, you can see that some of them look like fractals.
Searching for <a href="https://www.google.com/search?q=hokusai+fractal&amp;tbm=isch">Hokusai and fractal on Google images</a>
gives us a number of fractals that are similar to some of the Hokusai's paintings.</p>
<p>In this article, I'll use the Julia set fractal.
The fractal is quite easy to draw (especially using F#). To make it look similar to
The Great Wave off Kanagawa, we'll use a carefully chosen color palette to colorize the
fractal.</p>
<h3>Calculating Julia set</h3>
<p>You can find more information about <a href="http://en.wikipedia.org/wiki/Julia_set">Julia sets on Wikipedia</a>,
so I will not try to explain how exactly it works - the idea is that we generate a sequence
of complex numbers - at each step we calculate the next value as
<em>c<sub>next</sub> = c<sub>prev</sub><sup>2</sup> + c</em> where <em>c</em> is some constant.
The iteration can be nicely written as a recursive sequence expression that generates
(potentially) infinite sequence:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs3', 46)" onmouseover="showTip(event, 'fs3', 46)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs21', 47)" onmouseover="showTip(event, 'fs21', 47)" class="i">Drawing</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs3', 48)" onmouseover="showTip(event, 'fs3', 48)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 49)" onmouseover="showTip(event, 'fs22', 49)" class="i">Numerics</span>

<span class="c">/// Constant that generates nice fractal</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs23', 50)" onmouseover="showTip(event, 'fs23', 50)" class="i">c</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs24', 51)" onmouseover="showTip(event, 'fs24', 51)" class="t">Complex</span>(<span class="o">-</span><span class="n">0.70176</span>, <span class="o">-</span><span class="n">0.3842</span>)

<span class="c">/// Generates sequence for given coordinates</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs25', 52)" onmouseover="showTip(event, 'fs25', 52)" class="f">iterate</span> <span onmouseout="hideTip(event, 'fs26', 53)" onmouseover="showTip(event, 'fs26', 53)" class="i">x</span> <span onmouseout="hideTip(event, 'fs27', 54)" onmouseover="showTip(event, 'fs27', 54)" class="i">y</span> <span class="o">=</span>
  <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs28', 55)" onmouseover="showTip(event, 'fs28', 55)" class="f">loop</span> <span onmouseout="hideTip(event, 'fs29', 56)" onmouseover="showTip(event, 'fs29', 56)" class="i">current</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs30', 57)" onmouseover="showTip(event, 'fs30', 57)" class="i">seq</span> { 
    <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs29', 58)" onmouseover="showTip(event, 'fs29', 58)" class="i">current</span>
    <span class="k">yield!</span> <span onmouseout="hideTip(event, 'fs28', 59)" onmouseover="showTip(event, 'fs28', 59)" class="f">loop</span> (<span onmouseout="hideTip(event, 'fs29', 60)" onmouseover="showTip(event, 'fs29', 60)" class="i">current</span> <span class="o">**</span> <span class="n">2.0</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs23', 61)" onmouseover="showTip(event, 'fs23', 61)" class="i">c</span>) }
  <span onmouseout="hideTip(event, 'fs28', 62)" onmouseover="showTip(event, 'fs28', 62)" class="f">loop</span> (<span onmouseout="hideTip(event, 'fs24', 63)" onmouseover="showTip(event, 'fs24', 63)" class="t">Complex</span>(<span onmouseout="hideTip(event, 'fs26', 64)" onmouseover="showTip(event, 'fs26', 64)" class="i">x</span>, <span onmouseout="hideTip(event, 'fs27', 65)" onmouseover="showTip(event, 'fs27', 65)" class="i">y</span>))
</code></pre></td>
</tr>
</table>
<p>The function takes coordinates (in range from -1 to +1) and generates a sequence for one pixel
on the screen. Next, we need to count the number of iterations until the absolute value of the
number is greater than 2 (or until the maximum number of iterations exceeds a specified limit).
To do that, we can use functions from the <code>Seq</code> module:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs31', 66)" onmouseover="showTip(event, 'fs31', 66)" class="f">countIterations</span> <span onmouseout="hideTip(event, 'fs32', 67)" onmouseover="showTip(event, 'fs32', 67)" class="i">max</span> <span onmouseout="hideTip(event, 'fs26', 68)" onmouseover="showTip(event, 'fs26', 68)" class="i">x</span> <span onmouseout="hideTip(event, 'fs27', 69)" onmouseover="showTip(event, 'fs27', 69)" class="i">y</span> <span class="o">=</span> 
  <span onmouseout="hideTip(event, 'fs25', 70)" onmouseover="showTip(event, 'fs25', 70)" class="f">iterate</span> <span onmouseout="hideTip(event, 'fs26', 71)" onmouseover="showTip(event, 'fs26', 71)" class="i">x</span> <span onmouseout="hideTip(event, 'fs27', 72)" onmouseover="showTip(event, 'fs27', 72)" class="i">y</span>
  <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs33', 73)" onmouseover="showTip(event, 'fs33', 73)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs34', 74)" onmouseover="showTip(event, 'fs34', 74)" class="f">take</span> (<span onmouseout="hideTip(event, 'fs32', 75)" onmouseover="showTip(event, 'fs32', 75)" class="i">max</span> <span class="o">-</span> <span class="n">1</span>)
  <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs33', 76)" onmouseover="showTip(event, 'fs33', 76)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs35', 77)" onmouseover="showTip(event, 'fs35', 77)" class="f">takeWhile</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs36', 78)" onmouseover="showTip(event, 'fs36', 78)" class="i">v</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs24', 79)" onmouseover="showTip(event, 'fs24', 79)" class="t">Complex</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs37', 80)" onmouseover="showTip(event, 'fs37', 80)" class="f">Abs</span>(<span onmouseout="hideTip(event, 'fs36', 81)" onmouseover="showTip(event, 'fs36', 81)" class="i">v</span>) <span class="o">&lt;</span> <span class="n">2.0</span>)
  <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs33', 82)" onmouseover="showTip(event, 'fs33', 82)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs38', 83)" onmouseover="showTip(event, 'fs38', 83)" class="f">length</span>
</code></pre></td>
</tr>
</table>
<p>First, we restrict the number of iterations to the specified number, then we keep taking values
with small absolute value and, finally, we get the length of the sequence (when the absolute
value exceeds 2.0, the <code>takeWhile</code> function will end the sequence and <code>length</code> will be smaller
than <code>max - 1</code>). We could write the code in an imperative way - and it would likely be faster - but
this way, it clearly expresses the definition of Julia set.</p>
<h3>Generating color palette</h3>
<p>To draw the fractal, we'll iterate over all pixels where we want to draw, call
<code>countInterations</code> with a specified <code>x</code> and <code>y</code> arguments and then pick a color from a palette
based on the number of the iterations. To make the fractal that resembles Hokusai's paintings,
we need to carefully generate the palette - the idea is that we'll create a transition between
a number of colors that are used in The Great Wave off Kanagawa.</p>
<p>For this, we'll use a combination of two custom F# operators that let us write <code>clr1 -- count --&gt; clr2</code>.
The expression generates a color transition between <code>clr1</code> and <code>clr2</code> that has <code>count</code> number
of steps:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// Transition between colors in &#39;count&#39; steps</span>
<span class="k">let</span> (<span class="o">--</span>) <span onmouseout="hideTip(event, 'fs39', 84)" onmouseover="showTip(event, 'fs39', 84)" class="i">clr</span> <span onmouseout="hideTip(event, 'fs40', 85)" onmouseover="showTip(event, 'fs40', 85)" class="i">count</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs39', 86)" onmouseover="showTip(event, 'fs39', 86)" class="i">clr</span>, <span onmouseout="hideTip(event, 'fs40', 87)" onmouseover="showTip(event, 'fs40', 87)" class="i">count</span>
<span class="k">let</span> (<span class="o">--&gt;</span>) ((<span onmouseout="hideTip(event, 'fs41', 88)" onmouseover="showTip(event, 'fs41', 88)" class="i">r1</span>,<span onmouseout="hideTip(event, 'fs42', 89)" onmouseover="showTip(event, 'fs42', 89)" class="i">g1</span>,<span onmouseout="hideTip(event, 'fs43', 90)" onmouseover="showTip(event, 'fs43', 90)" class="i">b1</span>), <span onmouseout="hideTip(event, 'fs44', 91)" onmouseover="showTip(event, 'fs44', 91)" class="i">count</span>) (<span onmouseout="hideTip(event, 'fs45', 92)" onmouseover="showTip(event, 'fs45', 92)" class="i">r2</span>,<span onmouseout="hideTip(event, 'fs46', 93)" onmouseover="showTip(event, 'fs46', 93)" class="i">g2</span>,<span onmouseout="hideTip(event, 'fs47', 94)" onmouseover="showTip(event, 'fs47', 94)" class="i">b2</span>) <span class="o">=</span> [
  <span class="k">for</span> <span onmouseout="hideTip(event, 'fs48', 95)" onmouseover="showTip(event, 'fs48', 95)" class="i">c</span> <span class="k">in</span> <span class="n">0</span> <span class="o">..</span> <span onmouseout="hideTip(event, 'fs44', 96)" onmouseover="showTip(event, 'fs44', 96)" class="i">count</span> <span class="o">-</span> <span class="n">1</span> <span class="k">-&gt;</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs49', 97)" onmouseover="showTip(event, 'fs49', 97)" class="i">k</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs50', 98)" onmouseover="showTip(event, 'fs50', 98)" class="f">float</span> <span onmouseout="hideTip(event, 'fs48', 99)" onmouseover="showTip(event, 'fs48', 99)" class="i">c</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs50', 100)" onmouseover="showTip(event, 'fs50', 100)" class="f">float</span> <span onmouseout="hideTip(event, 'fs44', 101)" onmouseover="showTip(event, 'fs44', 101)" class="i">count</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs51', 102)" onmouseover="showTip(event, 'fs51', 102)" class="f">mid</span> <span onmouseout="hideTip(event, 'fs52', 103)" onmouseover="showTip(event, 'fs52', 103)" class="i">v1</span> <span onmouseout="hideTip(event, 'fs53', 104)" onmouseover="showTip(event, 'fs53', 104)" class="i">v2</span> <span class="o">=</span> 
      <span onmouseout="hideTip(event, 'fs54', 105)" onmouseover="showTip(event, 'fs54', 105)" class="f">int</span> (<span onmouseout="hideTip(event, 'fs50', 106)" onmouseover="showTip(event, 'fs50', 106)" class="f">float</span> <span onmouseout="hideTip(event, 'fs52', 107)" onmouseover="showTip(event, 'fs52', 107)" class="i">v1</span> <span class="o">+</span> ((<span onmouseout="hideTip(event, 'fs50', 108)" onmouseover="showTip(event, 'fs50', 108)" class="f">float</span> <span onmouseout="hideTip(event, 'fs53', 109)" onmouseover="showTip(event, 'fs53', 109)" class="i">v2</span>) <span class="o">-</span> (<span onmouseout="hideTip(event, 'fs50', 110)" onmouseover="showTip(event, 'fs50', 110)" class="f">float</span> <span onmouseout="hideTip(event, 'fs52', 111)" onmouseover="showTip(event, 'fs52', 111)" class="i">v1</span>)) <span class="o">*</span> <span onmouseout="hideTip(event, 'fs49', 112)" onmouseover="showTip(event, 'fs49', 112)" class="i">k</span>) 
    <span onmouseout="hideTip(event, 'fs55', 113)" onmouseover="showTip(event, 'fs55', 113)" class="t">Color</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs56', 114)" onmouseover="showTip(event, 'fs56', 114)" class="f">FromArgb</span>(<span onmouseout="hideTip(event, 'fs51', 115)" onmouseover="showTip(event, 'fs51', 115)" class="f">mid</span> <span onmouseout="hideTip(event, 'fs41', 116)" onmouseover="showTip(event, 'fs41', 116)" class="i">r1</span> <span onmouseout="hideTip(event, 'fs45', 117)" onmouseover="showTip(event, 'fs45', 117)" class="i">r2</span>, <span onmouseout="hideTip(event, 'fs51', 118)" onmouseover="showTip(event, 'fs51', 118)" class="f">mid</span> <span onmouseout="hideTip(event, 'fs42', 119)" onmouseover="showTip(event, 'fs42', 119)" class="i">g1</span> <span onmouseout="hideTip(event, 'fs46', 120)" onmouseover="showTip(event, 'fs46', 120)" class="i">g2</span>, <span onmouseout="hideTip(event, 'fs51', 121)" onmouseover="showTip(event, 'fs51', 121)" class="f">mid</span> <span onmouseout="hideTip(event, 'fs43', 122)" onmouseover="showTip(event, 'fs43', 122)" class="i">b1</span> <span onmouseout="hideTip(event, 'fs47', 123)" onmouseover="showTip(event, 'fs47', 123)" class="i">b2</span>) ]
</code></pre></td>
</tr>
</table>
<p>The <code>--</code> operator is a simple syntactic trick that just builds a tuple. Because the expression
is parsed as <code>(clr1 -- count) --&gt; clr2</code>, the second operator gets both the initial color and
the count as arguments and it can then generate a list with color transitions.</p>
<p>Generating the palette can now be nicely done using array expression with <code>yield!</code> to compose
individual transitions. We start with the color of the sky, then generate gradient with different
shades of blue (for water) and then add a number of white shades:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// Palette with colors used by Hokusai</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs57', 124)" onmouseover="showTip(event, 'fs57', 124)" class="i">palette</span> <span class="o">=</span> 
  [| <span class="c">// 3x sky color &amp; transition to light blue</span>
     <span class="k">yield!</span> (<span class="n">245</span>,<span class="n">219</span>,<span class="n">184</span>) <span class="o">--</span><span class="n">3</span><span class="o">--&gt;</span> (<span class="n">245</span>,<span class="n">219</span>,<span class="n">184</span>) 
     <span class="k">yield!</span> (<span class="n">245</span>,<span class="n">219</span>,<span class="n">184</span>) <span class="o">--</span><span class="n">4</span><span class="o">--&gt;</span> (<span class="n">138</span>,<span class="n">173</span>,<span class="n">179</span>)
     <span class="c">// to dark blue and then medium dark blue</span>
     <span class="k">yield!</span> (<span class="n">138</span>,<span class="n">173</span>,<span class="n">179</span>) <span class="o">--</span><span class="n">4</span><span class="o">--&gt;</span> (<span class="n">2</span>,<span class="n">12</span>,<span class="n">74</span>)
     <span class="k">yield!</span> (<span class="n">2</span>,<span class="n">12</span>,<span class="n">74</span>)     <span class="o">--</span><span class="n">4</span><span class="o">--&gt;</span> (<span class="n">61</span>,<span class="n">102</span>,<span class="n">130</span>)
     <span class="c">// to wave color, then light blue &amp; back to wave</span>
     <span class="k">yield!</span> (<span class="n">61</span>,<span class="n">102</span>,<span class="n">130</span>)  <span class="o">--</span> <span class="n">8</span><span class="o">--&gt;</span> (<span class="n">249</span>,<span class="n">243</span>,<span class="n">221</span>) 
     <span class="k">yield!</span> (<span class="n">249</span>,<span class="n">243</span>,<span class="n">221</span>) <span class="o">--</span><span class="n">32</span><span class="o">--&gt;</span> (<span class="n">138</span>,<span class="n">173</span>,<span class="n">179</span>) 
     <span class="k">yield!</span> (<span class="n">138</span>,<span class="n">173</span>,<span class="n">179</span>) <span class="o">--</span><span class="n">32</span><span class="o">--&gt;</span> (<span class="n">61</span>,<span class="n">102</span>,<span class="n">130</span>) |]
</code></pre></td>
</tr>
</table>
<h3>Drawing the fractal</h3>
<p>Now we have everything we need to draw the fractal. To keep the first version simple, let's just
use Windows Forms and <code>Bitmap</code> from <code>System.Drawing</code>. I'll skip over the code that creates the
form (but you can find the <a href="https://github.com/tpetricek/TomaspNet.Website/tree/master/source/blog/2013">full source code on GitHub</a>).</p>
<p>After we create the form and bitmap, we simply iterate over all pixels of the bitmap,
count the number of iterations (using the palette length as the maximal number) and
then index into the palette to get the color:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span id="fst58" onmouseout="hideTip(event, 'fs58', 125)" onmouseover="showTip(event, 'fs58', 125, document.getElementById('fst58'))" class="omitted">(Create form with picture box)</span>

<span class="c">// Specifies what range of the set to draw</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs59', 126)" onmouseover="showTip(event, 'fs59', 126)" class="i">w</span> <span class="o">=</span> <span class="o">-</span><span class="n">0.4</span>, <span class="n">0.4</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs60', 127)" onmouseover="showTip(event, 'fs60', 127)" class="i">h</span> <span class="o">=</span> <span class="o">-</span><span class="n">0.95</span>, <span class="o">-</span><span class="n">0.35</span>

<span class="c">// Create bitmap that matches the size of the form</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs61', 128)" onmouseover="showTip(event, 'fs61', 128)" class="i">width</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs50', 129)" onmouseover="showTip(event, 'fs50', 129)" class="f">float</span> <span onmouseout="hideTip(event, 'fs62', 130)" onmouseover="showTip(event, 'fs62', 130)" class="i">f</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs63', 131)" onmouseover="showTip(event, 'fs63', 131)" class="i">ClientSize</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs64', 132)" onmouseover="showTip(event, 'fs64', 132)" class="i">Width</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs65', 133)" onmouseover="showTip(event, 'fs65', 133)" class="i">height</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs50', 134)" onmouseover="showTip(event, 'fs50', 134)" class="f">float</span> <span onmouseout="hideTip(event, 'fs62', 135)" onmouseover="showTip(event, 'fs62', 135)" class="i">f</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs63', 136)" onmouseover="showTip(event, 'fs63', 136)" class="i">ClientSize</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs66', 137)" onmouseover="showTip(event, 'fs66', 137)" class="i">Height</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs67', 138)" onmouseover="showTip(event, 'fs67', 138)" class="i">bmp</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs68', 139)" onmouseover="showTip(event, 'fs68', 139)" class="t">Bitmap</span>(<span onmouseout="hideTip(event, 'fs62', 140)" onmouseover="showTip(event, 'fs62', 140)" class="i">f</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs63', 141)" onmouseover="showTip(event, 'fs63', 141)" class="i">ClientSize</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs64', 142)" onmouseover="showTip(event, 'fs64', 142)" class="i">Width</span>, <span onmouseout="hideTip(event, 'fs62', 143)" onmouseover="showTip(event, 'fs62', 143)" class="i">f</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs63', 144)" onmouseover="showTip(event, 'fs63', 144)" class="i">ClientSize</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs66', 145)" onmouseover="showTip(event, 'fs66', 145)" class="i">Height</span>)

<span class="c">// For each pixel, transform to the specified range</span>
<span class="c">// and get color using countInterations and palette</span>
<span class="k">for</span> <span onmouseout="hideTip(event, 'fs69', 146)" onmouseover="showTip(event, 'fs69', 146)" class="i">x</span> <span class="k">in</span> <span class="n">0</span> <span class="o">..</span> <span onmouseout="hideTip(event, 'fs67', 147)" onmouseover="showTip(event, 'fs67', 147)" class="i">bmp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs70', 148)" onmouseover="showTip(event, 'fs70', 148)" class="i">Width</span> <span class="o">-</span> <span class="n">1</span> <span class="k">do</span>
  <span class="k">for</span> <span onmouseout="hideTip(event, 'fs71', 149)" onmouseover="showTip(event, 'fs71', 149)" class="i">y</span> <span class="k">in</span> <span class="n">0</span> <span class="o">..</span> <span onmouseout="hideTip(event, 'fs67', 150)" onmouseover="showTip(event, 'fs67', 150)" class="i">bmp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs72', 151)" onmouseover="showTip(event, 'fs72', 151)" class="i">Height</span> <span class="o">-</span> <span class="n">1</span> <span class="k">do</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs73', 152)" onmouseover="showTip(event, 'fs73', 152)" class="i">x&#39;</span> <span class="o">=</span> (<span onmouseout="hideTip(event, 'fs50', 153)" onmouseover="showTip(event, 'fs50', 153)" class="f">float</span> <span onmouseout="hideTip(event, 'fs69', 154)" onmouseover="showTip(event, 'fs69', 154)" class="i">x</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs61', 155)" onmouseover="showTip(event, 'fs61', 155)" class="i">width</span> <span class="o">*</span> (<span onmouseout="hideTip(event, 'fs74', 156)" onmouseover="showTip(event, 'fs74', 156)" class="f">snd</span> <span onmouseout="hideTip(event, 'fs59', 157)" onmouseover="showTip(event, 'fs59', 157)" class="i">w</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs75', 158)" onmouseover="showTip(event, 'fs75', 158)" class="f">fst</span> <span onmouseout="hideTip(event, 'fs59', 159)" onmouseover="showTip(event, 'fs59', 159)" class="i">w</span>)) <span class="o">+</span> <span onmouseout="hideTip(event, 'fs75', 160)" onmouseover="showTip(event, 'fs75', 160)" class="f">fst</span> <span onmouseout="hideTip(event, 'fs59', 161)" onmouseover="showTip(event, 'fs59', 161)" class="i">w</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs76', 162)" onmouseover="showTip(event, 'fs76', 162)" class="i">y&#39;</span> <span class="o">=</span> (<span onmouseout="hideTip(event, 'fs50', 163)" onmouseover="showTip(event, 'fs50', 163)" class="f">float</span> <span onmouseout="hideTip(event, 'fs71', 164)" onmouseover="showTip(event, 'fs71', 164)" class="i">y</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs65', 165)" onmouseover="showTip(event, 'fs65', 165)" class="i">height</span> <span class="o">*</span> (<span onmouseout="hideTip(event, 'fs74', 166)" onmouseover="showTip(event, 'fs74', 166)" class="f">snd</span> <span onmouseout="hideTip(event, 'fs60', 167)" onmouseover="showTip(event, 'fs60', 167)" class="i">h</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs75', 168)" onmouseover="showTip(event, 'fs75', 168)" class="f">fst</span> <span onmouseout="hideTip(event, 'fs60', 169)" onmouseover="showTip(event, 'fs60', 169)" class="i">h</span>)) <span class="o">+</span> <span onmouseout="hideTip(event, 'fs75', 170)" onmouseover="showTip(event, 'fs75', 170)" class="f">fst</span> <span onmouseout="hideTip(event, 'fs60', 171)" onmouseover="showTip(event, 'fs60', 171)" class="i">h</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs77', 172)" onmouseover="showTip(event, 'fs77', 172)" class="i">it</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs31', 173)" onmouseover="showTip(event, 'fs31', 173)" class="f">countIterations</span> <span onmouseout="hideTip(event, 'fs57', 174)" onmouseover="showTip(event, 'fs57', 174)" class="i">palette</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs78', 175)" onmouseover="showTip(event, 'fs78', 175)" class="i">Length</span> <span onmouseout="hideTip(event, 'fs73', 176)" onmouseover="showTip(event, 'fs73', 176)" class="i">x&#39;</span> <span onmouseout="hideTip(event, 'fs76', 177)" onmouseover="showTip(event, 'fs76', 177)" class="i">y&#39;</span> 
    <span onmouseout="hideTip(event, 'fs67', 178)" onmouseover="showTip(event, 'fs67', 178)" class="i">bmp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs79', 179)" onmouseover="showTip(event, 'fs79', 179)" class="f">SetPixel</span>(<span onmouseout="hideTip(event, 'fs69', 180)" onmouseover="showTip(event, 'fs69', 180)" class="i">x</span>, <span onmouseout="hideTip(event, 'fs71', 181)" onmouseover="showTip(event, 'fs71', 181)" class="i">y</span>, <span onmouseout="hideTip(event, 'fs57', 182)" onmouseover="showTip(event, 'fs57', 182)" class="i">palette</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs77', 183)" onmouseover="showTip(event, 'fs77', 183)" class="i">it</span>])
<span onmouseout="hideTip(event, 'fs80', 184)" onmouseover="showTip(event, 'fs80', 184)" class="i">i</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs81', 185)" onmouseover="showTip(event, 'fs81', 185)" class="i">Image</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs67', 186)" onmouseover="showTip(event, 'fs67', 186)" class="i">bmp</span>
</code></pre></td>
</tr>
</table>
<p>The parameters <code>w</code> and <code>h</code> are tuples that specify the part of the fractal that we want to
draw. You can change the values to <code>-2.0, 2.0</code> and <code>-1.5, 1.5</code> to see the entire fractal.
Here, I picked a special part of the fractal to get the following nice picture:</p>
<div style="text-align:center;padding-right:40px">
<img src="compared.jpg" style="margin-left:auto;margin-right:auto;" />
</div>
<h2>Adding some Fun(Script)</h2>
<p>So, we now have a code that draws the fractal, but you probably want to see it running live,
without creating a new Windows Forms project. Luckily, we can use <a href="http://funscript.info/">FunScript</a>
which is an F# to JavaScript compiler and we can render our fractal using HTML5 <code>&lt;canvas&gt;</code> element.
FunScript already has an example that draws Mandelbrot fractals using HTML5, so this will be
quite easy - but the key thing is, we can just reuse all the code we wrote so far. As I don't have
space to describe all the details, here are some important links:</p>
<ul>
<li>For more information about FunScript, see the <a href="http://funscript.info">project homepage</a></li>
<li>
The <a href="https://github.com/tpetricek/FunScript/tree/master/Examples/Hokusai">source code for the FunScript version</a>
is available in my GitHub.
</li>
<li>You can also have a look at <a href="hokusai.html">the live running version of the code</a>.</li>
</ul>
<p>Let's start by looking how the rendering function changes. As you can see in the live JavaScript
version, the rendering is a bit slow and so we update the displayed picture after drawing each
line (since we just copied the original code to dynamically typed JavaScript, the slow down is
expected - we could use imperative style to make the code faster).</p>
<p>However, we can elegantly change the code to update the picture by wrapping the rendering
function in an F# <code>async</code> workflow and adding <code>Async.Sleep</code> after the drawing of a single
line is finished:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">/// Render fractal asynchronously with sleep after every line</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs96', 201)" onmouseover="showTip(event, 'fs96', 201)" class="f">render</span> () <span class="o">=</span> <span onmouseout="hideTip(event, 'fs97', 202)" onmouseover="showTip(event, 'fs97', 202)" class="i">async</span> {
  <span class="c">// Get &lt;canvas&gt; element &amp; create image for drawing</span>
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs98', 203)" onmouseover="showTip(event, 'fs98', 203)" class="i">canv</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs99', 204)" onmouseover="showTip(event, 'fs99', 204)" class="t">HTMLCanvasElement</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs100', 205)" onmouseover="showTip(event, 'fs100', 205)" class="t">Globals</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs101', 206)" onmouseover="showTip(event, 'fs101', 206)" class="i">document</span><span class="o">?</span><span class="i">canvas</span>
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs102', 207)" onmouseover="showTip(event, 'fs102', 207)" class="i">ctx</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs98', 208)" onmouseover="showTip(event, 'fs98', 208)" class="i">canv</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs103', 209)" onmouseover="showTip(event, 'fs103', 209)" class="f">getContext_2d</span>()
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs84', 210)" onmouseover="showTip(event, 'fs84', 210)" class="i">img</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs102', 211)" onmouseover="showTip(event, 'fs102', 211)" class="i">ctx</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs104', 212)" onmouseover="showTip(event, 'fs104', 212)" class="f">createImageData</span>(<span onmouseout="hideTip(event, 'fs50', 213)" onmouseover="showTip(event, 'fs50', 213)" class="f">float</span> <span onmouseout="hideTip(event, 'fs61', 214)" onmouseover="showTip(event, 'fs61', 214)" class="i">width</span>, <span onmouseout="hideTip(event, 'fs50', 215)" onmouseover="showTip(event, 'fs50', 215)" class="f">float</span> <span onmouseout="hideTip(event, 'fs65', 216)" onmouseover="showTip(event, 'fs65', 216)" class="i">height</span>)
    
  <span class="c">// For each pixel, transform to the specified range</span>
  <span class="c">// and get color using countInterations and palette</span>
  <span class="k">for</span> <span onmouseout="hideTip(event, 'fs105', 217)" onmouseover="showTip(event, 'fs105', 217)" class="i">x</span> <span class="k">in</span> <span class="n">0</span> <span class="o">..</span> <span onmouseout="hideTip(event, 'fs54', 218)" onmouseover="showTip(event, 'fs54', 218)" class="f">int</span> <span onmouseout="hideTip(event, 'fs61', 219)" onmouseover="showTip(event, 'fs61', 219)" class="i">width</span> <span class="o">-</span> <span class="n">1</span> <span class="k">do</span>
    <span class="k">for</span> <span onmouseout="hideTip(event, 'fs106', 220)" onmouseover="showTip(event, 'fs106', 220)" class="i">y</span> <span class="k">in</span> <span class="n">0</span> <span class="o">..</span> <span onmouseout="hideTip(event, 'fs54', 221)" onmouseover="showTip(event, 'fs54', 221)" class="f">int</span> <span onmouseout="hideTip(event, 'fs65', 222)" onmouseover="showTip(event, 'fs65', 222)" class="i">height</span> <span class="o">-</span> <span class="n">1</span> <span class="k">do</span> 
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs73', 223)" onmouseover="showTip(event, 'fs73', 223)" class="i">x&#39;</span> <span class="o">=</span> (<span onmouseout="hideTip(event, 'fs50', 224)" onmouseover="showTip(event, 'fs50', 224)" class="f">float</span> <span onmouseout="hideTip(event, 'fs105', 225)" onmouseover="showTip(event, 'fs105', 225)" class="i">x</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs61', 226)" onmouseover="showTip(event, 'fs61', 226)" class="i">width</span> <span class="o">*</span> (<span onmouseout="hideTip(event, 'fs74', 227)" onmouseover="showTip(event, 'fs74', 227)" class="f">snd</span> <span onmouseout="hideTip(event, 'fs59', 228)" onmouseover="showTip(event, 'fs59', 228)" class="i">w</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs75', 229)" onmouseover="showTip(event, 'fs75', 229)" class="f">fst</span> <span onmouseout="hideTip(event, 'fs59', 230)" onmouseover="showTip(event, 'fs59', 230)" class="i">w</span>)) <span class="o">+</span> <span onmouseout="hideTip(event, 'fs75', 231)" onmouseover="showTip(event, 'fs75', 231)" class="f">fst</span> <span onmouseout="hideTip(event, 'fs59', 232)" onmouseover="showTip(event, 'fs59', 232)" class="i">w</span>
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs76', 233)" onmouseover="showTip(event, 'fs76', 233)" class="i">y&#39;</span> <span class="o">=</span> (<span onmouseout="hideTip(event, 'fs50', 234)" onmouseover="showTip(event, 'fs50', 234)" class="f">float</span> <span onmouseout="hideTip(event, 'fs106', 235)" onmouseover="showTip(event, 'fs106', 235)" class="i">y</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs65', 236)" onmouseover="showTip(event, 'fs65', 236)" class="i">height</span> <span class="o">*</span> (<span onmouseout="hideTip(event, 'fs74', 237)" onmouseover="showTip(event, 'fs74', 237)" class="f">snd</span> <span onmouseout="hideTip(event, 'fs60', 238)" onmouseover="showTip(event, 'fs60', 238)" class="i">h</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs75', 239)" onmouseover="showTip(event, 'fs75', 239)" class="f">fst</span> <span onmouseout="hideTip(event, 'fs60', 240)" onmouseover="showTip(event, 'fs60', 240)" class="i">h</span>)) <span class="o">+</span> <span onmouseout="hideTip(event, 'fs75', 241)" onmouseover="showTip(event, 'fs75', 241)" class="f">fst</span> <span onmouseout="hideTip(event, 'fs60', 242)" onmouseover="showTip(event, 'fs60', 242)" class="i">h</span>
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs77', 243)" onmouseover="showTip(event, 'fs77', 243)" class="i">it</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs31', 244)" onmouseover="showTip(event, 'fs31', 244)" class="f">countIterations</span> <span onmouseout="hideTip(event, 'fs82', 245)" onmouseover="showTip(event, 'fs82', 245)" class="i">palette</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs78', 246)" onmouseover="showTip(event, 'fs78', 246)" class="i">Length</span> <span onmouseout="hideTip(event, 'fs73', 247)" onmouseover="showTip(event, 'fs73', 247)" class="i">x&#39;</span> <span onmouseout="hideTip(event, 'fs76', 248)" onmouseover="showTip(event, 'fs76', 248)" class="i">y&#39;</span> 
      <span onmouseout="hideTip(event, 'fs83', 249)" onmouseover="showTip(event, 'fs83', 249)" class="f">setPixel</span> <span onmouseout="hideTip(event, 'fs84', 250)" onmouseover="showTip(event, 'fs84', 250)" class="i">img</span> <span onmouseout="hideTip(event, 'fs105', 251)" onmouseover="showTip(event, 'fs105', 251)" class="i">x</span> <span onmouseout="hideTip(event, 'fs106', 252)" onmouseover="showTip(event, 'fs106', 252)" class="i">y</span> <span onmouseout="hideTip(event, 'fs61', 253)" onmouseover="showTip(event, 'fs61', 253)" class="i">width</span> <span onmouseout="hideTip(event, 'fs82', 254)" onmouseover="showTip(event, 'fs82', 254)" class="i">palette</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs77', 255)" onmouseover="showTip(event, 'fs77', 255)" class="i">it</span>]

    <span class="c">// Insert non-blocking waiting &amp; update the fractal</span>
    <span class="k">do!</span> <span onmouseout="hideTip(event, 'fs107', 256)" onmouseover="showTip(event, 'fs107', 256)" class="t">Async</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs108', 257)" onmouseover="showTip(event, 'fs108', 257)" class="f">Sleep</span>(<span class="n">1</span>)
    <span onmouseout="hideTip(event, 'fs102', 258)" onmouseover="showTip(event, 'fs102', 258)" class="i">ctx</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs109', 259)" onmouseover="showTip(event, 'fs109', 259)" class="f">putImageData</span>(<span onmouseout="hideTip(event, 'fs84', 260)" onmouseover="showTip(event, 'fs84', 260)" class="i">img</span>, <span class="n">0.0</span>, <span class="n">0.0</span>) }
</code></pre></td>
</tr>
</table>
<p>The code is mostly the same as previously. Note that FunScript has typed wrappers for most
of the JavaScript libraries, so all variables in the code are statically typed (e.g. <code>canv</code>
is <code>HTMLCanvasElement</code> and has methods like <code>getContext_2d</code> for getting rendering context).
We use a helper function <code>setPixel</code> to set a color of a single pixel and a dynamic lookup
operator <code>?</code> to get HTML element by ID (both shown in the next paragraph). To start the
rendering, we need to setup an event handler and call <code>StartImmediate</code>:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// Setup button event handler to start the rendering</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs110', 261)" onmouseover="showTip(event, 'fs110', 261)" class="i">go</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs111', 262)" onmouseover="showTip(event, 'fs111', 262)" class="t">HTMLButtonElement</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs100', 263)" onmouseover="showTip(event, 'fs100', 263)" class="t">Globals</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs101', 264)" onmouseover="showTip(event, 'fs101', 264)" class="i">document</span><span class="o">?</span><span onmouseout="hideTip(event, 'fs110', 265)" onmouseover="showTip(event, 'fs110', 265)" class="i">go</span>
<span onmouseout="hideTip(event, 'fs110', 266)" onmouseover="showTip(event, 'fs110', 266)" class="i">go</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs112', 267)" onmouseover="showTip(event, 'fs112', 267)" class="f">addEventListener_click</span>(<span class="k">fun</span> _ <span class="k">-&gt;</span> 
  <span onmouseout="hideTip(event, 'fs96', 268)" onmouseover="showTip(event, 'fs96', 268)" class="f">render</span>() <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs107', 269)" onmouseover="showTip(event, 'fs107', 269)" class="t">Async</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs113', 270)" onmouseover="showTip(event, 'fs113', 270)" class="f">StartImmediate</span>; <span class="k">null</span>)  
</code></pre></td>
</tr>
</table>
<p>The two helper functions that we need are fairly simple too - <code>setPixel</code> calculates the offset
in <code>ImageData</code> array and sets the R, G and B components (as well as the alpha channel). The
dynamic operator just calls <code>getElementById</code> and casts the returned element to the expected
type:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">/// Set pixel value in ImageData to a given color</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs114', 271)" onmouseover="showTip(event, 'fs114', 271)" class="f">setPixel</span> (<span onmouseout="hideTip(event, 'fs84', 272)" onmouseover="showTip(event, 'fs84', 272)" class="i">img</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs85', 273)" onmouseover="showTip(event, 'fs85', 273)" class="t">ImageData</span>) <span onmouseout="hideTip(event, 'fs105', 274)" onmouseover="showTip(event, 'fs105', 274)" class="i">x</span> <span onmouseout="hideTip(event, 'fs106', 275)" onmouseover="showTip(event, 'fs106', 275)" class="i">y</span> <span onmouseout="hideTip(event, 'fs115', 276)" onmouseover="showTip(event, 'fs115', 276)" class="i">width</span> (<span onmouseout="hideTip(event, 'fs116', 277)" onmouseover="showTip(event, 'fs116', 277)" class="i">r</span>, <span onmouseout="hideTip(event, 'fs117', 278)" onmouseover="showTip(event, 'fs117', 278)" class="i">g</span>, <span onmouseout="hideTip(event, 'fs118', 279)" onmouseover="showTip(event, 'fs118', 279)" class="i">b</span>) <span class="o">=</span>
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs119', 280)" onmouseover="showTip(event, 'fs119', 280)" class="i">index</span> <span class="o">=</span> (<span onmouseout="hideTip(event, 'fs105', 281)" onmouseover="showTip(event, 'fs105', 281)" class="i">x</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs106', 282)" onmouseover="showTip(event, 'fs106', 282)" class="i">y</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs54', 283)" onmouseover="showTip(event, 'fs54', 283)" class="f">int</span> <span onmouseout="hideTip(event, 'fs115', 284)" onmouseover="showTip(event, 'fs115', 284)" class="i">width</span>) <span class="o">*</span> <span class="n">4</span>
  <span onmouseout="hideTip(event, 'fs84', 285)" onmouseover="showTip(event, 'fs84', 285)" class="i">img</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs120', 286)" onmouseover="showTip(event, 'fs120', 286)" class="i">data</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs119', 287)" onmouseover="showTip(event, 'fs119', 287)" class="i">index</span><span class="o">+</span><span class="n">0</span>] <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs116', 288)" onmouseover="showTip(event, 'fs116', 288)" class="i">r</span>
  <span onmouseout="hideTip(event, 'fs84', 289)" onmouseover="showTip(event, 'fs84', 289)" class="i">img</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs120', 290)" onmouseover="showTip(event, 'fs120', 290)" class="i">data</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs119', 291)" onmouseover="showTip(event, 'fs119', 291)" class="i">index</span><span class="o">+</span><span class="n">1</span>] <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs117', 292)" onmouseover="showTip(event, 'fs117', 292)" class="i">g</span>
  <span onmouseout="hideTip(event, 'fs84', 293)" onmouseover="showTip(event, 'fs84', 293)" class="i">img</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs120', 294)" onmouseover="showTip(event, 'fs120', 294)" class="i">data</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs119', 295)" onmouseover="showTip(event, 'fs119', 295)" class="i">index</span><span class="o">+</span><span class="n">2</span>] <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs118', 296)" onmouseover="showTip(event, 'fs118', 296)" class="i">b</span>
  <span onmouseout="hideTip(event, 'fs84', 297)" onmouseover="showTip(event, 'fs84', 297)" class="i">img</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs120', 298)" onmouseover="showTip(event, 'fs120', 298)" class="i">data</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs119', 299)" onmouseover="showTip(event, 'fs119', 299)" class="i">index</span><span class="o">+</span><span class="n">3</span>] <span class="o">&lt;-</span> <span class="n">255.0</span>

<span class="c">/// Dynamic operator that returns HTML element by ID</span>
<span class="k">let</span> (<span class="o">?</span>) (<span onmouseout="hideTip(event, 'fs92', 300)" onmouseover="showTip(event, 'fs92', 300)" class="i">doc</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs93', 301)" onmouseover="showTip(event, 'fs93', 301)" class="t">Document</span>) <span onmouseout="hideTip(event, 'fs121', 302)" onmouseover="showTip(event, 'fs121', 302)" class="i">name</span> <span class="o">:</span><span class="o">&#39;</span><span class="i">R</span> <span class="o">=</span>  
  <span onmouseout="hideTip(event, 'fs92', 303)" onmouseover="showTip(event, 'fs92', 303)" class="i">doc</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs122', 304)" onmouseover="showTip(event, 'fs122', 304)" class="f">getElementById</span>(<span onmouseout="hideTip(event, 'fs121', 305)" onmouseover="showTip(event, 'fs121', 305)" class="i">name</span>) <span class="o">:?&gt;</span> <span class="o">&#39;</span><span class="i">R</span>
</code></pre></td>
</tr>
</table>
<h2>Conclusions</h2>
<p>First of all, I hope that you had as much fun reading the article as I had writing it and
I wish you a very nice Christmas season!</p>
<p>As I mentioned in the introduction, I wanted to show some interesting libraries that have
been recently developed by the F# community and I wanted to do this using a theme inspired
by Japan. We started by using <a href="http://fsharp.github.io/FSharp.Data/">F# Data</a> and, more
specifically, the Freebase type provider, to get a list of Japanese visual artists and their
art works.</p>
<p>Then we picked Hokusai and tried to recreate his Great Wave off Kanagawa using Julia set
with an appropriately chosen palette. Our first version was rendered using Windows Forms.
To make the code runnable directly in a web browser, we used FunScript to translate F# to
JavaScript - and we did not have to do almost any changes in the code. We only added asynchronous
workflows (as a bonus) so that we can see how the rendering of the fractal progresses.</p>


<div class="tip" id="fs1">Multiple items<br />namespace FSharp<br /><br />--------------------<br />namespace Microsoft.FSharp</div>
<div class="tip" id="fs2">Multiple items<br />namespace FSharp.Data<br /><br />--------------------<br />namespace Microsoft.FSharp.Data</div>
<div class="tip" id="fs3">namespace System</div>
<div class="tip" id="fs4">namespace System.Linq</div>
<div class="tip" id="fs5">type FreebaseData = FreebaseDataProvider&lt;...&gt;<br /><br />Full name: Japan-advent-art-en.FreebaseData</div>
<div class="tip" id="fs6">type FreebaseDataProvider<br /><br />Full name: FSharp.Data.FreebaseDataProvider<br /><em><br /><br />&lt;summary&gt;Typed representation of Freebase data with additional configuration parameters&lt;/summary&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;param name=&#39;Key&#39;&gt;The API key for the MQL metadata service (default: none)&lt;/param&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;param name=&#39;ServiceUrl&#39;&gt;The service URL for the MQL metadata service (default: https://www.googleapis.com/freebase/v1)&lt;/param&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;param name=&#39;NumIndividuals&#39;&gt;The maximum number of sample individuals for each Freebase type (default: 1000)&lt;/param&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;param name=&#39;UseUnitsOfMeasure&#39;&gt;Use the unit-of-measure annotations from the data source metadata (default: true)&lt;/param&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;param name=&#39;Pluralize&#39;&gt;Use adhoc rules to pluralize the names of types when forming names of collections (default: true)&lt;/param&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;param name=&#39;SnapshotDate&#39;&gt;Use a snapshot of the web data store at the given date and/or time in ISO8601 format, e.g., 2012-01-18, 2012-09-15T21:11:32. A value of &#39;now&#39; indicates the compile time of the code. (default: no snapshot)&lt;/param&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;param name=&#39;LocalCache&#39;&gt;Use a persistent local cache for schema requests. Also provides the default for whether a persistent local cache is used at runtime. A per-session cache is always used for schema data but it will not persist if this is set to &#39;false&#39;. (default: true)&lt;/param&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;param name=&#39;AllowLocalQueryEvaluation&#39;&gt;Allow local evalution of some parts of a query. If false, then an exception will be raised if a query can&#39;t be evaluated fully on the server. If true, data sets may be implicitly brought to the client for processing. (default: true)&lt;/param&gt;</em></div>
<div class="tip" id="fs7">&quot;AIzaSyCEgJTvxPjj6zqLKTK06nPYkUooSO1tB0w&quot;</div>
<div class="tip" id="fs8">val fb : FreebaseDataProvider&lt;...&gt;.ServiceTypes.FreebaseService<br /><br />Full name: Japan-advent-art-en.fb</div>
<div class="tip" id="fs9">Multiple items<br />FreebaseDataProvider&lt;...&gt;.GetDataContext() : FreebaseDataProvider&lt;...&gt;.ServiceTypes.FreebaseService<br /><br />--------------------<br />FreebaseData.GetDataContext() : FreebaseData.ServiceTypes.FreebaseService</div>
<div class="tip" id="fs10">val art : obj<br /><br />Full name: Japan-advent-art-en.art</div>
<div class="tip" id="fs11">val ldv : obj<br /><br />Full name: Japan-advent-art-en.ldv</div>
<div class="tip" id="fs12">val artists : IQueryable&lt;obj&gt;<br /><br />Full name: Japan-advent-art-en.artists</div>
<div class="tip" id="fs13">val query : Linq.QueryBuilder<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.query</div>
<div class="tip" id="fs14">val p : obj</div>
<div class="tip" id="fs15">custom operation: where (bool)<br /><br />Calls Linq.QueryBuilder.Where </div>
<div class="tip" id="fs16">val a : obj</div>
<div class="tip" id="fs17">val printfn : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.printfn</div>
<div class="tip" id="fs18">val hok : IQueryable&lt;obj&gt;<br /><br />Full name: Japan-advent-art-en.hok</div>
<div class="tip" id="fs19">val p : Linq.QuerySource&lt;obj,IQueryable&gt;</div>
<div class="tip" id="fs20">custom operation: head<br /><br />Calls Linq.QueryBuilder.Head </div>
<div class="tip" id="fs21">namespace System.Drawing</div>
<div class="tip" id="fs22">namespace System.Numerics</div>
<div class="tip" id="fs23">val c : Complex<br /><br />Full name: Japan-advent-art-en.c<br /><em><br /><br />&#160;Constant that generates nice fractal</em></div>
<div class="tip" id="fs24">Multiple items<br />type Complex =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;new : real:float * imaginary:float -&gt; Complex<br />&#160;&#160;&#160;&#160;member Equals : obj:obj -&gt; bool + 1 overload<br />&#160;&#160;&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;&#160;&#160;member Imaginary : float<br />&#160;&#160;&#160;&#160;member Magnitude : float<br />&#160;&#160;&#160;&#160;member Phase : float<br />&#160;&#160;&#160;&#160;member Real : float<br />&#160;&#160;&#160;&#160;member ToString : unit -&gt; string + 3 overloads<br />&#160;&#160;&#160;&#160;static val Zero : Complex<br />&#160;&#160;&#160;&#160;static val One : Complex<br />&#160;&#160;&#160;&#160;...<br />&#160;&#160;end<br /><br />Full name: System.Numerics.Complex<br /><br />--------------------<br />Complex()<br />Complex(real: float, imaginary: float) : unit</div>
<div class="tip" id="fs25">val iterate : x:float -&gt; y:float -&gt; seq&lt;Complex&gt;<br /><br />Full name: Japan-advent-art-en.iterate<br /><em><br /><br />&#160;Generates sequence for given coordinates</em></div>
<div class="tip" id="fs26">val x : float</div>
<div class="tip" id="fs27">val y : float</div>
<div class="tip" id="fs28">val loop : (Complex -&gt; seq&lt;Complex&gt;)</div>
<div class="tip" id="fs29">val current : Complex</div>
<div class="tip" id="fs30">Multiple items<br />val seq : sequence:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Core.Operators.seq<br /><br />--------------------<br />type seq&lt;&#39;T&gt; = System.Collections.Generic.IEnumerable&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.seq&lt;_&gt;</div>
<div class="tip" id="fs31">val countIterations : max:int -&gt; x:float -&gt; y:float -&gt; int<br /><br />Full name: Japan-advent-art-en.countIterations</div>
<div class="tip" id="fs32">val max : int</div>
<div class="tip" id="fs33">module Seq<br /><br />from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs34">val take : count:int -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.take</div>
<div class="tip" id="fs35">val takeWhile : predicate:(&#39;T -&gt; bool) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.takeWhile</div>
<div class="tip" id="fs36">val v : Complex</div>
<div class="tip" id="fs37">Complex.Abs(value: Complex) : float</div>
<div class="tip" id="fs38">val length : source:seq&lt;&#39;T&gt; -&gt; int<br /><br />Full name: Microsoft.FSharp.Collections.Seq.length</div>
<div class="tip" id="fs39">val clr : &#39;a</div>
<div class="tip" id="fs40">val count : &#39;b</div>
<div class="tip" id="fs41">val r1 : int</div>
<div class="tip" id="fs42">val g1 : int</div>
<div class="tip" id="fs43">val b1 : int</div>
<div class="tip" id="fs44">val count : int</div>
<div class="tip" id="fs45">val r2 : int</div>
<div class="tip" id="fs46">val g2 : int</div>
<div class="tip" id="fs47">val b2 : int</div>
<div class="tip" id="fs48">val c : int</div>
<div class="tip" id="fs49">val k : float</div>
<div class="tip" id="fs50">Multiple items<br />val float : value:&#39;T -&gt; float (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.float<br /><br />--------------------<br />type float = System.Double<br /><br />Full name: Microsoft.FSharp.Core.float<br /><br />--------------------<br />type float&lt;&#39;Measure&gt; = float<br /><br />Full name: Microsoft.FSharp.Core.float&lt;_&gt;</div>
<div class="tip" id="fs51">val mid : (int -&gt; int -&gt; int)</div>
<div class="tip" id="fs52">val v1 : int</div>
<div class="tip" id="fs53">val v2 : int</div>
<div class="tip" id="fs54">Multiple items<br />val int : value:&#39;T -&gt; int (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.int<br /><br />--------------------<br />type int = int32<br /><br />Full name: Microsoft.FSharp.Core.int<br /><br />--------------------<br />type int&lt;&#39;Measure&gt; = int<br /><br />Full name: Microsoft.FSharp.Core.int&lt;_&gt;</div>
<div class="tip" id="fs55">type Color =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;member A : byte<br />&#160;&#160;&#160;&#160;member B : byte<br />&#160;&#160;&#160;&#160;member Equals : obj:obj -&gt; bool<br />&#160;&#160;&#160;&#160;member G : byte<br />&#160;&#160;&#160;&#160;member GetBrightness : unit -&gt; float32<br />&#160;&#160;&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;&#160;&#160;member GetHue : unit -&gt; float32<br />&#160;&#160;&#160;&#160;member GetSaturation : unit -&gt; float32<br />&#160;&#160;&#160;&#160;member IsEmpty : bool<br />&#160;&#160;&#160;&#160;member IsKnownColor : bool<br />&#160;&#160;&#160;&#160;...<br />&#160;&#160;end<br /><br />Full name: System.Drawing.Color</div>
<div class="tip" id="fs56">Color.FromArgb(argb: int) : Color<br />Color.FromArgb(alpha: int, baseColor: Color) : Color<br />Color.FromArgb(red: int, green: int, blue: int) : Color<br />Color.FromArgb(alpha: int, red: int, green: int, blue: int) : Color</div>
<div class="tip" id="fs57">val palette : Color []<br /><br />Full name: Japan-advent-art-en.palette</div>
<div class="tip" id="fs58">open System.Windows.Forms<br /><br />let f = new Form(Visible=true, ClientSize=Size(400, 300))<br />let i = new PictureBox()<br />i.SizeMode &lt;- PictureBoxSizeMode.Zoom<br />i.Dock &lt;- DockStyle.Fill<br />f.Controls.Add(i)</div>
<div class="tip" id="fs59">val w : float * float<br /><br />Full name: Japan-advent-art-en.w</div>
<div class="tip" id="fs60">val h : float * float<br /><br />Full name: Japan-advent-art-en.h</div>
<div class="tip" id="fs61">val width : float<br /><br />Full name: Japan-advent-art-en.width</div>
<div class="tip" id="fs62">val f : Form<br /><br />Full name: Japan-advent-art-en.f</div>
<div class="tip" id="fs63">property Form.ClientSize: Size</div>
<div class="tip" id="fs64">property Size.Width: int</div>
<div class="tip" id="fs65">val height : float<br /><br />Full name: Japan-advent-art-en.height</div>
<div class="tip" id="fs66">property Size.Height: int</div>
<div class="tip" id="fs67">val bmp : Bitmap<br /><br />Full name: Japan-advent-art-en.bmp</div>
<div class="tip" id="fs68">Multiple items<br />type Bitmap =<br />&#160;&#160;inherit Image<br />&#160;&#160;new : filename:string -&gt; Bitmap + 11 overloads<br />&#160;&#160;member Clone : rect:Rectangle * format:PixelFormat -&gt; Bitmap + 1 overload<br />&#160;&#160;member GetHbitmap : unit -&gt; nativeint + 1 overload<br />&#160;&#160;member GetHicon : unit -&gt; nativeint<br />&#160;&#160;member GetPixel : x:int * y:int -&gt; Color<br />&#160;&#160;member LockBits : rect:Rectangle * flags:ImageLockMode * format:PixelFormat -&gt; BitmapData + 1 overload<br />&#160;&#160;member MakeTransparent : unit -&gt; unit + 1 overload<br />&#160;&#160;member SetPixel : x:int * y:int * color:Color -&gt; unit<br />&#160;&#160;member SetResolution : xDpi:float32 * yDpi:float32 -&gt; unit<br />&#160;&#160;member UnlockBits : bitmapdata:BitmapData -&gt; unit<br />&#160;&#160;...<br /><br />Full name: System.Drawing.Bitmap<br /><br />--------------------<br />Bitmap(filename: string) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />Bitmap(stream: System.IO.Stream) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />Bitmap(original: Image) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />Bitmap(filename: string, useIcm: bool) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />Bitmap(type: System.Type, resource: string) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />Bitmap(stream: System.IO.Stream, useIcm: bool) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />Bitmap(width: int, height: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />Bitmap(original: Image, newSize: Size) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />Bitmap(width: int, height: int, format: Imaging.PixelFormat) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />Bitmap(width: int, height: int, g: Graphics) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em></div>
<div class="tip" id="fs69">val x : int32</div>
<div class="tip" id="fs70">property Image.Width: int</div>
<div class="tip" id="fs71">val y : int32</div>
<div class="tip" id="fs72">property Image.Height: int</div>
<div class="tip" id="fs73">val x&#39; : float</div>
<div class="tip" id="fs74">val snd : tuple:(&#39;T1 * &#39;T2) -&gt; &#39;T2<br /><br />Full name: Microsoft.FSharp.Core.Operators.snd</div>
<div class="tip" id="fs75">val fst : tuple:(&#39;T1 * &#39;T2) -&gt; &#39;T1<br /><br />Full name: Microsoft.FSharp.Core.Operators.fst</div>
<div class="tip" id="fs76">val y&#39; : float</div>
<div class="tip" id="fs77">val it : int</div>
<div class="tip" id="fs78">property System.Array.Length: int</div>
<div class="tip" id="fs79">Bitmap.SetPixel(x: int, y: int, color: Color) : unit</div>
<div class="tip" id="fs80">val i : PictureBox<br /><br />Full name: Japan-advent-art-en.i</div>
<div class="tip" id="fs81">property PictureBox.Image: Image</div>
<div class="tip" id="fs82">val palette : (float * float * float) []<br /><br />Full name: Japan-advent-art-en.palette</div>
<div class="tip" id="fs83">val setPixel : img:ImageData -&gt; x:&#39;a -&gt; y:&#39;b -&gt; width:&#39;c -&gt; r:&#39;d * g:&#39;e * b:&#39;f -&gt; unit<br /><br />Full name: Japan-advent-art-en.setPixel</div>
<div class="tip" id="fs84">val img : ImageData</div>
<div class="tip" id="fs85">type ImageData<br /><br />Full name: ImageData</div>
<div class="tip" id="fs86">val x : &#39;a</div>
<div class="tip" id="fs87">val y : &#39;b</div>
<div class="tip" id="fs88">val width : &#39;c</div>
<div class="tip" id="fs89">val r : &#39;d</div>
<div class="tip" id="fs90">val g : &#39;e</div>
<div class="tip" id="fs91">val b : &#39;f</div>
<div class="tip" id="fs92">val doc : Document</div>
<div class="tip" id="fs93">type Document =<br />&#160;&#160;interface<br />&#160;&#160;&#160;&#160;inherit MSNodeExtensions<br />&#160;&#160;&#160;&#160;inherit MSResourceMetadata<br />&#160;&#160;&#160;&#160;inherit DocumentEvent<br />&#160;&#160;&#160;&#160;inherit MSEventAttachmentTarget<br />&#160;&#160;&#160;&#160;inherit NodeSelector<br />&#160;&#160;&#160;&#160;inherit Node<br />&#160;&#160;end<br /><br />Full name: Document</div>
<div class="tip" id="fs94">val name : &#39;a</div>
<div class="tip" id="fs95">val failwith : message:string -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.Operators.failwith</div>
<div class="tip" id="fs96">val render : unit -&gt; Async&lt;unit&gt;<br /><br />Full name: Japan-advent-art-en.render<br /><em><br /><br />&#160;Render fractal asynchronously with sleep after every line</em></div>
<div class="tip" id="fs97">val async : AsyncBuilder<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.async</div>
<div class="tip" id="fs98">val canv : HTMLCanvasElement</div>
<div class="tip" id="fs99">type HTMLCanvasElement =<br />&#160;&#160;interface<br />&#160;&#160;&#160;&#160;inherit HTMLElement<br />&#160;&#160;end<br /><br />Full name: HTMLCanvasElement</div>
<div class="tip" id="fs100">type Globals<br /><br />Full name: Globals</div>
<div class="tip" id="fs101">property Globals.document: Document</div>
<div class="tip" id="fs102">val ctx : CanvasRenderingContext2D</div>
<div class="tip" id="fs103">member HTMLCanvasElement.getContext_2d : unit -&gt; CanvasRenderingContext2D</div>
<div class="tip" id="fs104">member CanvasRenderingContext2D.createImageData : imageDataOrSw:obj * ?sh:float -&gt; ImageData</div>
<div class="tip" id="fs105">val x : int</div>
<div class="tip" id="fs106">val y : int</div>
<div class="tip" id="fs107">Multiple items<br />type Async<br />static member AsBeginEnd : computation:(&#39;Arg -&gt; Async&lt;&#39;T&gt;) -&gt; (&#39;Arg * AsyncCallback * obj -&gt; IAsyncResult) * (IAsyncResult -&gt; &#39;T) * (IAsyncResult -&gt; unit)<br />static member AwaitEvent : event:IEvent&lt;&#39;Del,&#39;T&gt; * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt; (requires delegate and &#39;Del :&gt; Delegate)<br />static member AwaitIAsyncResult : iar:IAsyncResult * ?millisecondsTimeout:int -&gt; Async&lt;bool&gt;<br />static member AwaitTask : task:Task -&gt; Async&lt;unit&gt;<br />static member AwaitTask : task:Task&lt;&#39;T&gt; -&gt; Async&lt;&#39;T&gt;<br />static member AwaitWaitHandle : waitHandle:WaitHandle * ?millisecondsTimeout:int -&gt; Async&lt;bool&gt;<br />static member CancelDefaultToken : unit -&gt; unit<br />static member Catch : computation:Async&lt;&#39;T&gt; -&gt; Async&lt;Choice&lt;&#39;T,exn&gt;&gt;<br />static member FromBeginEnd : beginAction:(AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromBeginEnd : arg:&#39;Arg1 * beginAction:(&#39;Arg1 * AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromBeginEnd : arg1:&#39;Arg1 * arg2:&#39;Arg2 * beginAction:(&#39;Arg1 * &#39;Arg2 * AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromBeginEnd : arg1:&#39;Arg1 * arg2:&#39;Arg2 * arg3:&#39;Arg3 * beginAction:(&#39;Arg1 * &#39;Arg2 * &#39;Arg3 * AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromContinuations : callback:((&#39;T -&gt; unit) * (exn -&gt; unit) * (OperationCanceledException -&gt; unit) -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member Ignore : computation:Async&lt;&#39;T&gt; -&gt; Async&lt;unit&gt;<br />static member OnCancel : interruption:(unit -&gt; unit) -&gt; Async&lt;IDisposable&gt;<br />static member Parallel : computations:seq&lt;Async&lt;&#39;T&gt;&gt; -&gt; Async&lt;&#39;T []&gt;<br />static member RunSynchronously : computation:Async&lt;&#39;T&gt; * ?timeout:int * ?cancellationToken:CancellationToken -&gt; &#39;T<br />static member Sleep : millisecondsDueTime:int -&gt; Async&lt;unit&gt;<br />static member Start : computation:Async&lt;unit&gt; * ?cancellationToken:CancellationToken -&gt; unit<br />static member StartAsTask : computation:Async&lt;&#39;T&gt; * ?taskCreationOptions:TaskCreationOptions * ?cancellationToken:CancellationToken -&gt; Task&lt;&#39;T&gt;<br />static member StartChild : computation:Async&lt;&#39;T&gt; * ?millisecondsTimeout:int -&gt; Async&lt;Async&lt;&#39;T&gt;&gt;<br />static member StartChildAsTask : computation:Async&lt;&#39;T&gt; * ?taskCreationOptions:TaskCreationOptions -&gt; Async&lt;Task&lt;&#39;T&gt;&gt;<br />static member StartImmediate : computation:Async&lt;unit&gt; * ?cancellationToken:CancellationToken -&gt; unit<br />static member StartWithContinuations : computation:Async&lt;&#39;T&gt; * continuation:(&#39;T -&gt; unit) * exceptionContinuation:(exn -&gt; unit) * cancellationContinuation:(OperationCanceledException -&gt; unit) * ?cancellationToken:CancellationToken -&gt; unit<br />static member SwitchToContext : syncContext:SynchronizationContext -&gt; Async&lt;unit&gt;<br />static member SwitchToNewThread : unit -&gt; Async&lt;unit&gt;<br />static member SwitchToThreadPool : unit -&gt; Async&lt;unit&gt;<br />static member TryCancelled : computation:Async&lt;&#39;T&gt; * compensation:(OperationCanceledException -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member CancellationToken : Async&lt;CancellationToken&gt;<br />static member DefaultCancellationToken : CancellationToken<br /><br />Full name: Microsoft.FSharp.Control.Async<br /><br />--------------------<br />type Async&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Control.Async&lt;_&gt;</div>
<div class="tip" id="fs108">static member Async.Sleep : millisecondsDueTime:int -&gt; Async&lt;unit&gt;</div>
<div class="tip" id="fs109">member CanvasRenderingContext2D.putImageData : imagedata:ImageData * dx:float * dy:float * ?dirtyX:float * ?dirtyY:float * ?dirtyWidth:float * ?dirtyHeight:float -&gt; unit</div>
<div class="tip" id="fs110">val go : HTMLButtonElement<br /><br />Full name: Japan-advent-art-en.go</div>
<div class="tip" id="fs111">type HTMLButtonElement =<br />&#160;&#160;interface<br />&#160;&#160;&#160;&#160;inherit MSDataBindingExtensions<br />&#160;&#160;&#160;&#160;inherit HTMLElement<br />&#160;&#160;end<br /><br />Full name: HTMLButtonElement</div>
<div class="tip" id="fs112">member HTMLElement.addEventListener_click : listener:System.Func&lt;MouseEvent,obj&gt; * ?useCapture:bool -&gt; unit</div>
<div class="tip" id="fs113">static member Async.StartImmediate : computation:Async&lt;unit&gt; * ?cancellationToken:System.Threading.CancellationToken -&gt; unit</div>
<div class="tip" id="fs114">val setPixel : img:ImageData -&gt; x:int -&gt; y:int -&gt; width:int -&gt; r:float * g:float * b:float -&gt; unit<br /><br />Full name: Japan-advent-art-en.setPixel<br /><em><br /><br />&#160;Set pixel value in ImageData to a given color</em></div>
<div class="tip" id="fs115">val width : int</div>
<div class="tip" id="fs116">val r : float</div>
<div class="tip" id="fs117">val g : float</div>
<div class="tip" id="fs118">val b : float</div>
<div class="tip" id="fs119">val index : int</div>
<div class="tip" id="fs120">property ImageData.data: float array</div>
<div class="tip" id="fs121">val name : string</div>
<div class="tip" id="fs122">member Document.getElementById : elementId:string -&gt; HTMLElement</div>


    <div class="info">
    <p class="share">
        <a target="_blank" href="https://twitter.com/intent/tweet?url=http%3a%2f%2ftomasp.net%2fblog%2f2014%2fjapan-advent-art-en%2f&amp;text=Advent+Art%3a+Generating+Hokusai+paintingsvia+%40tomaspetricek">
          <i class="fab fa-twitter-square"></i></a>
        <a target="_blank" href="https://www.facebook.com/sharer.php?u=http%3a%2f%2ftomasp.net%2fblog%2f2014%2fjapan-advent-art-en%2f">
          <i class="fab fa-facebook-square"></i></a>
        <a href="http://www.reddit.com/submit?url=http%3a%2f%2ftomasp.net%2fblog%2f2014%2fjapan-advent-art-en%2f&title=Advent+Art%3a+Generating+Hokusai+paintings">
          <i class="fab fa-reddit-square"></i></a>
        <a href="mailto:?subject=Advent%20Art%3a%20Generating%20Hokusai%20paintings&body=%20This%20article%20is%20a%20contribution%20to%20the%20F%23%20Advent%20Calendar%20that%20is%20organized%20every%20year%20by%20the%20Japanese%20F%23%20community%20-%20and%20so%20the%20article%20is%20inspired%20by%20the%20Japanese%20culture.%20We%20look%20at%20a%20list%20of%20Japanese%20artists%20in%20Freebase%20and%20try%20to%20recreate%20one%20piece%20using%20fractals%20and%20FunScript!%0a%0aSee%3a%20http%3a%2f%2ftomasp.net%2fblog%2f2014%2fjapan-advent-art-en%2f">
          <i class="fa fa-envelope"></i></a>
    </p>
    <p class="details">
      <strong>Published:</strong> Tuesday, 21 January 2014, 6:49 PM<br />
      <strong>Author:</strong> Tomas Petricek<br />
      <strong>Typos:</strong> <a href="http://github.com/tpetricek/tomasp.net">Send me a pull request</a>!<br />
      
        <strong>Tags:</strong> <a
          href="/blog/tag/fsharp/">f#</a>, <a
          href="/blog/tag/art/">art</a>, <a
          href="/blog/tag/fractals/">fractals</a>, <a
          href="/blog/tag/funscript/">funscript</a>, <a
          href="/blog/tag/fsharp-data/">f# data</a></span><br />
      
    </p>
    </div>
  </article>


  <footer>
  <div class="footer-body">
    <div class="fl70"><div class="fmr">
      <h4><a href="http://tomasp.net/rss.xml"><i class="fa fa-rss" style="margin-right:5px;"></i></a> Blog archives</h4>
      <p>
      
      <a href="/blog/archive/february_2025/">February 2025 (1)</a>,&nbsp;
      
      <a href="/blog/archive/december_2023/">December 2023 (1)</a>,&nbsp;
      
      <a href="/blog/archive/february_2023/">February 2023 (1)</a>,&nbsp;
      
      <a href="/blog/archive/september_2022/">September 2022 (1)</a>,&nbsp;
      
      <a href="/blog/archive/april_2022/">April 2022 (1)</a>,&nbsp;
      
      <a href="/blog/archive/october_2021/">October 2021 (1)</a>,&nbsp;
      
      <a href="/blog/archive/april_2021/">April 2021 (1)</a>,&nbsp;
      
      <a href="/blog/archive/october_2020/">October 2020 (1)</a>,&nbsp;
      
      <a href="/blog/archive/july_2020/">July 2020 (1)</a>,&nbsp;
      
      <a href="/blog/archive/april_2020/">April 2020 (2)</a>,&nbsp;
      
      <a href="/blog/archive/december_2019/">December 2019 (1)</a>,&nbsp;
      
      <a href="/blog/archive/february_2019/">February 2019 (1)</a>,&nbsp;
      
      <a href="/blog/archive/november_2018/">November 2018 (1)</a>,&nbsp;
      
      <a href="/blog/archive/october_2018/">October 2018 (1)</a>,&nbsp;
      
      <a href="/blog/archive/may_2018/">May 2018 (1)</a>,&nbsp;
      
      <a href="/blog/archive/september_2017/">September 2017 (1)</a>,&nbsp;
      
      <a href="/blog/archive/june_2017/">June 2017 (1)</a>,&nbsp;
      
      <a href="/blog/archive/april_2017/">April 2017 (1)</a>,&nbsp;
      
      <a href="/blog/archive/march_2017/">March 2017 (2)</a>,&nbsp;
      
      <a href="/blog/archive/january_2017/">January 2017 (1)</a>,&nbsp;
      
      <a href="/blog/archive/october_2016/">October 2016 (1)</a>,&nbsp;
      
      <a href="/blog/archive/september_2016/">September 2016 (2)</a>,&nbsp;
      
      <a href="/blog/archive/august_2016/">August 2016 (1)</a>,&nbsp;
      
      <a href="/blog/archive/july_2016/">July 2016 (1)</a>,&nbsp;
      
      <a href="/blog/archive/may_2016/">May 2016 (2)</a>,&nbsp;
      
      <a href="/blog/archive/april_2016/">April 2016 (1)</a>,&nbsp;
      
      <a href="/blog/archive/december_2015/">December 2015 (2)</a>,&nbsp;
      
      <a href="/blog/archive/november_2015/">November 2015 (1)</a>,&nbsp;
      
      <a href="/blog/archive/september_2015/">September 2015 (3)</a>,&nbsp;
      
      <a href="/blog/archive/july_2015/">July 2015 (1)</a>,&nbsp;
      
      <a href="/blog/archive/june_2015/">June 2015 (1)</a>,&nbsp;
      
      <a href="/blog/archive/may_2015/">May 2015 (2)</a>,&nbsp;
      
      <a href="/blog/archive/april_2015/">April 2015 (3)</a>,&nbsp;
      
      <a href="/blog/archive/march_2015/">March 2015 (2)</a>,&nbsp;
      
      <a href="/blog/archive/february_2015/">February 2015 (1)</a>,&nbsp;
      
      <a href="/blog/archive/january_2015/">January 2015 (2)</a>,&nbsp;
      
      <a href="/blog/archive/december_2014/">December 2014 (1)</a>,&nbsp;
      
      <a href="/blog/archive/may_2014/">May 2014 (3)</a>,&nbsp;
      
      <a href="/blog/archive/april_2014/">April 2014 (2)</a>,&nbsp;
      
      <a href="/blog/archive/march_2014/">March 2014 (1)</a>,&nbsp;
      
      <a href="/blog/archive/january_2014/">January 2014 (2)</a>,&nbsp;
      
      <a href="/blog/archive/december_2013/">December 2013 (1)</a>,&nbsp;
      
      <a href="/blog/archive/november_2013/">November 2013 (1)</a>,&nbsp;
      
      <a href="/blog/archive/october_2013/">October 2013 (1)</a>,&nbsp;
      
      <a href="/blog/archive/september_2013/">September 2013 (1)</a>,&nbsp;
      
      <a href="/blog/archive/august_2013/">August 2013 (2)</a>,&nbsp;
      
      <a href="/blog/archive/may_2013/">May 2013 (1)</a>,&nbsp;
      
      <a href="/blog/archive/april_2013/">April 2013 (1)</a>,&nbsp;
      
      <a href="/blog/archive/march_2013/">March 2013 (1)</a>,&nbsp;
      
      <a href="/blog/archive/february_2013/">February 2013 (1)</a>,&nbsp;
      
      <a href="/blog/archive/january_2013/">January 2013 (1)</a>,&nbsp;
      
      <a href="/blog/archive/december_2012/">December 2012 (2)</a>,&nbsp;
      
      <a href="/blog/archive/october_2012/">October 2012 (1)</a>,&nbsp;
      
      <a href="/blog/archive/august_2012/">August 2012 (3)</a>,&nbsp;
      
      <a href="/blog/archive/june_2012/">June 2012 (2)</a>,&nbsp;
      
      <a href="/blog/archive/april_2012/">April 2012 (1)</a>,&nbsp;
      
      <a href="/blog/archive/march_2012/">March 2012 (4)</a>,&nbsp;
      
      <a href="/blog/archive/february_2012/">February 2012 (5)</a>,&nbsp;
      
      <a href="/blog/archive/january_2012/">January 2012 (2)</a>,&nbsp;
      
      <a href="/blog/archive/november_2011/">November 2011 (5)</a>,&nbsp;
      
      <a href="/blog/archive/august_2011/">August 2011 (3)</a>,&nbsp;
      
      <a href="/blog/archive/july_2011/">July 2011 (2)</a>,&nbsp;
      
      <a href="/blog/archive/june_2011/">June 2011 (2)</a>,&nbsp;
      
      <a href="/blog/archive/may_2011/">May 2011 (2)</a>,&nbsp;
      
      <a href="/blog/archive/march_2011/">March 2011 (4)</a>,&nbsp;
      
      <a href="/blog/archive/december_2010/">December 2010 (1)</a>,&nbsp;
      
      <a href="/blog/archive/november_2010/">November 2010 (6)</a>,&nbsp;
      
      <a href="/blog/archive/october_2010/">October 2010 (6)</a>,&nbsp;
      
      <a href="/blog/archive/september_2010/">September 2010 (4)</a>,&nbsp;
      
      <a href="/blog/archive/july_2010/">July 2010 (3)</a>,&nbsp;
      
      <a href="/blog/archive/june_2010/">June 2010 (2)</a>,&nbsp;
      
      <a href="/blog/archive/may_2010/">May 2010 (1)</a>,&nbsp;
      
      <a href="/blog/archive/february_2010/">February 2010 (2)</a>,&nbsp;
      
      <a href="/blog/archive/january_2010/">January 2010 (3)</a>,&nbsp;
      
      <a href="/blog/archive/december_2009/">December 2009 (3)</a>,&nbsp;
      
      <a href="/blog/archive/july_2009/">July 2009 (1)</a>,&nbsp;
      
      <a href="/blog/archive/june_2009/">June 2009 (3)</a>,&nbsp;
      
      <a href="/blog/archive/may_2009/">May 2009 (2)</a>,&nbsp;
      
      <a href="/blog/archive/april_2009/">April 2009 (1)</a>,&nbsp;
      
      <a href="/blog/archive/march_2009/">March 2009 (2)</a>,&nbsp;
      
      <a href="/blog/archive/february_2009/">February 2009 (1)</a>,&nbsp;
      
      <a href="/blog/archive/december_2008/">December 2008 (1)</a>,&nbsp;
      
      <a href="/blog/archive/november_2008/">November 2008 (5)</a>,&nbsp;
      
      <a href="/blog/archive/october_2008/">October 2008 (1)</a>,&nbsp;
      
      <a href="/blog/archive/september_2008/">September 2008 (1)</a>,&nbsp;
      
      <a href="/blog/archive/june_2008/">June 2008 (1)</a>,&nbsp;
      
      <a href="/blog/archive/march_2008/">March 2008 (3)</a>,&nbsp;
      
      <a href="/blog/archive/february_2008/">February 2008 (1)</a>,&nbsp;
      
      <a href="/blog/archive/december_2007/">December 2007 (2)</a>,&nbsp;
      
      <a href="/blog/archive/november_2007/">November 2007 (6)</a>,&nbsp;
      
      <a href="/blog/archive/october_2007/">October 2007 (1)</a>,&nbsp;
      
      <a href="/blog/archive/september_2007/">September 2007 (1)</a>,&nbsp;
      
      <a href="/blog/archive/august_2007/">August 2007 (1)</a>,&nbsp;
      
      <a href="/blog/archive/july_2007/">July 2007 (2)</a>,&nbsp;
      
      <a href="/blog/archive/april_2007/">April 2007 (2)</a>,&nbsp;
      
      <a href="/blog/archive/march_2007/">March 2007 (2)</a>,&nbsp;
      
      <a href="/blog/archive/february_2007/">February 2007 (3)</a>,&nbsp;
      
      <a href="/blog/archive/january_2007/">January 2007 (2)</a>,&nbsp;
      
      <a href="/blog/archive/november_2006/">November 2006 (1)</a>,&nbsp;
      
      <a href="/blog/archive/october_2006/">October 2006 (3)</a>,&nbsp;
      
      <a href="/blog/archive/august_2006/">August 2006 (2)</a>,&nbsp;
      
      <a href="/blog/archive/july_2006/">July 2006 (1)</a>,&nbsp;
      
      <a href="/blog/archive/june_2006/">June 2006 (3)</a>,&nbsp;
      
      <a href="/blog/archive/may_2006/">May 2006 (2)</a>,&nbsp;
      
      <a href="/blog/archive/april_2006/">April 2006 (2)</a>,&nbsp;
      
      <a href="/blog/archive/december_2005/">December 2005 (1)</a>,&nbsp;
      
      <a href="/blog/archive/july_2005/">July 2005 (4)</a>,&nbsp;
      
      <a href="/blog/archive/june_2005/">June 2005 (5)</a>,&nbsp;
      
      <a href="/blog/archive/may_2005/">May 2005 (1)</a>,&nbsp;
      
      <a href="/blog/archive/april_2005/">April 2005 (3)</a>,&nbsp;
      
      <a href="/blog/archive/march_2005/">March 2005 (3)</a>,&nbsp;
      
      <a href="/blog/archive/january_2005/">January 2005 (1)</a>,&nbsp;
      
      <a href="/blog/archive/december_2004/">December 2004 (3)</a>,&nbsp;
      
      <a href="/blog/archive/november_2004/">November 2004 (2)</a>,&nbsp;
      
      </p>
    </div></div>
    <div class="fr30"><div class="fmr">
      <h4>License and about</h4>
      <p>All articles on this site are licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution Share Alike</a>.
        All source code samples are licensed under the MIT License.
      </p>
      <p>This site is hosted on GitHub and is generated using <a href="https://github.com/tpetricek/FSharp.Formatting">F# Formatting</a>
        and <a href="http://dotliquidmarkup.org/">DotLiquid</a>.
        For more info, see the <a href="https://github.com/tpetricek/tomasp.net">website source on GitHub</a>.
      </p>
      <p>Please submit issues &amp; corrections on GitHub. Use pull requests for minor corrections only.</p>
      <ul>
        <li><i class="fab fa-twitter"></i> Twitter: <a href="http://twitter.com/tomaspetricek">@tomaspetricek</a></li>
        <li><i class="fab fa-github"></i> GitHub: <a href="https://github.com/tpetricek">@tpetricek</a></li>
        <li><i class="fa fa-envelope"></i> Email: <a href="mailto:tomas@tomasp.net">tomas@tomasp.net</a></li>
      </ul>
      <p style="text-align:center;margin-top:15px;"><img src="https://tomasp.net/img/cc-sa.png" alt="CC License logo" /></p>
    </div></div>
  </div>
  </footer>

  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-1561220-1']);
    _gaq.push(['_trackPageview']);
    (function () {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
</body>
</html>
